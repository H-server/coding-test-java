SELECT B.CAR_ID, A.CAR_TYPE, ROUND((DAILY_FEE * 30 * (100 - C.DISCOUNT_RATE)/100)) AS FEE
FROM CAR_RENTAL_COMPANY_CAR A 
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY B ON A.CAR_ID = B.CAR_ID
JOIN (SELECT * 
      FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN 
      WHERE CAR_TYPE IN ('SUV', '세단') AND DURATION_TYPE = '30일 이상') AS C ON A.CAR_TYPE = C.CAR_TYPE
WHERE A.CAR_TYPE IN ('SUV', '세단')
AND B.CAR_ID NOT IN (SELECT CAR_ID 
                     FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
                     WHERE !(END_DATE < '2022-11-01' OR START_DATE > '2022-11-30'))
AND (DAILY_FEE * 30 * (100 - C.DISCOUNT_RATE)/100 >= 500000 AND DAILY_FEE * 30 * (100 - C.DISCOUNT_RATE)/100 < 2000000)
GROUP BY B.CAR_ID
ORDER BY FEE DESC, A.CAR_TYPE, B.CAR_ID DESC


#날짜 등호?
# 2시 50분 첫풀이 15분